,sS$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$Ss,
$$$$'                    qico, an ftn compatible mailer                    `$$$$
$$$$.                           * version 0.49 *                           ,$$$$
`?S$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$S?'

Features:
~~~~~~~~
 * Протоколы EMSI, ZModem, ZedZap, Hydra (Std, 8k, 16k), Janus 
 * Поддержка 4D Binkley-Style, Amiga-style outbound, FileBoxes, LongNameBoxes
 * "Морда" - программа, позволяющая наблюдать за работой мейлера (ncurses based)
 * Режим демона для исходящих звонков
 * Асинхронная работа менеджера очереди и сессий (как входящих, так и 
   исходящих).
 * Встроенный быстрый компилятор нодлистов c маленькими индексами 
 * Встроенная утилита для работы с аутбаундом, более удобная, т.к. следит за
   состоянием bsy-файлов.
 * Подстановки (substs) с поддержкой hidden-линий.
 * Проверка файл-флагов запрета исходящих звонков на портах.
 * Встроенная "гляделка" нодлиста.
 * Динамическая конфигурация - возможность изменять большинство параметров
   конфига во время работы в зависимости от различных условий.
 * Возможность ограничения времени на сессию
 * Поддержка ifextrp-совместимых фрекпроцессоров (только WaZOO запросы)
 * Поддержка всевозможных перобразований локальных и посылаемых путей и имен
   файлов (поддержка досовских аутбаундов и т.д.)
 * Возможность ограничения минимальной скорости коннекта
 
Building & Installation
~~~~~~~~~~~~~~~~~~~~~~~
   Проверено на рабочесть под:
     - Linux 2.2.11-4bc i586 (glibc-2.1, ncurses-4.2)
     - FreeBSD 2.2.6-4.0
       (Note: для сборки на 2.2.x-3.x qcc должна стоять ncurses из портов!)

   На других OS не пробовал, но очень хочу узнать, что получится ;)
   На архитектурах, отличных от х86 пока не работает ввиду зависимости в 
   некоторых местах от порядка байт. Как только в мой телнет попадет живой 
   big-endian, сделаю поддержку ;) 

   $ configure --help
   $ configure [нужные опции]
   $ gmake
   $ gmake install или gamek install-strip
   
   Положить конфиг в нужное место, подправить его под свои нужды.
  
Using
~~~~~
 * Для исходящих достаточно запускать qico -d из какого-нибудь startup-скрипта,
   а poll'ы генерить по cron'у.
 * Бинарник qico обязательно должен быть suid на того юзера, которому принадлежит
   аутбаунд (обычно это ifmail, fido или news) 
 * Для входящих (в случае mgetty) необходимо вписать следующую строчку в
   login.config (mgetty должен быть собран с -DFIDO):
       /FIDO/  $USER $USER $BINDIR/qico -a @
   где $USER и $BINDIR значения соответствующих переменных из CONFIG.
 * Можно еще прописать в inetd.conf, но на самом деле поддержка tcp/ip пока
   малопригодна для использования и предназначена только для отладки.

Notes:
~~~~~
 # Поддерживается _только_ 4D BSO, т.к. 5D имхо и нафиг не нужен - только
   глюки плодить. При ftn-style софте потери совсем незаметно, а для гейта,
   если хочется f56.n34.z12.othernet.org, а не f56.n34.z12.fidonet.org, то
   можно юзать domtrans. И потом, не забывайте про сим- и хардлинки ;)
  
 # .REQ является поводом для звонка и аналогичен паре .REQ+.FLO для ifcico.

 # Структура .STS: <N попытки> <флаги> <время окончания холда>   

 # Все временные промежутки могут быть указаны как в формате d.hh:mm-d.hh:mm 
   (дни и/или минуты могут быть опущены), тогда они воспринимаются как 
   локальное время, так и в формате Txy, тогда они считаются относительно UTC.
   Вместо 00:00-23:59 можно просто написать CM, вместо 0:00-0:00 - Never
   Можно написать несколько промежутков через запятую.
   В условиях также можно использовать промежутки в формате ifcico (иногда 
   это удобнее).

 # Чтобы описать хиддены, просто пропишите несколько subst'ов для одного адреса.
   Нодлистовая линия в этом случае игнорируется, так что ее надо тоже прописать
   как subst.

 # Если у вас совсем нет никаких листов и они и ненужны, все равно придется 
   прописать хотя бы один (хоть и несущестсвующий) лист и создать пустой 
   индекс, запустив 'qico -n'.
   
 # Если нужно перечитать конфиги, не делайте "killall -HUP qico", т.к. это
   загасит все открытые сессии ;) Правильнее делать qctl -R.
   Это также относится и к "killall qico"/"qctl -q". 
 
 # Вся информация, которая используется для проверки условий в конфиге
   до emsi берется из нодлиста и subst'ов, а после - из полученного emsi.

 # В качестве фрекпроцессора можно взять мой же ifextrp-pk (лежит там же,
   где и qico) или оригинальный ifextrp by Serge Oskin.

 # В одной из следующих версий скорее всего займусь глобальной переделкой 
   алгоритма работы qcc, так что пока лучше ее просто отрубить ;)

 # "History" сделана для быстрой и легкой генерации статистики (должно хватать
   одного awk). Формат следующий (одна строка - одна сессия):
   <line>,<time>,<length>,[P][L]{I|O}{1|0},<address>,<sent_bytes>,<recd_bytes>
   где <line> - терминал или tcpip для tcp/ip-сессий
       <time> и <length> - в секнудах (unix time)
       P - protected, L - listed, 
       I/O - inbound/outbound, 
       1/0 - succesful/failed
 
 # FileBox'ы сделаны по аналогии с ifcico - файлы из них отдаются в самом конце,
   poll'а не вызывают, после успешной передачи удаляются. Обрабатываются
   только обычные файлы и симлинки. LongNameBox'ы - тоже самое, только просматривается
   каталогс именем вида '$longboxpath/zone.net.node.point'.

 # Прочитайте внимательно верхушку конфига насчет условий! Эта штука позволяет
   разделить логи/инбаунды/аутбаунды/прятать или добавлять разные aka
   для разных линий и/или в зависимости от времени, удаленного адреса, телефона
   CID'а и т.д. Короче, на каждую комбинацию условий у вас фактически будет
   отдельный конфиг.  

 # Догадываюсь, что описание опции mapout в конфиге более чем туманно, так что
   попробую объяснить по русски ;) Итак, преобразования имен делятся на два 
   типа - преобразование локальных имен, которые будут открываться для 
   пересылки и имен, под которыми файлы получит удаленная сторона. 
   Преобразования, заданные большими буквами + mappath влияют только на 
   локальное имя, их надо подогнать так, чтобы файлы прописанные в лошках
   мейлер мог открыть, а остальные преобразования можно уже настроить так, как
   вам хочется, чтобы ремота получала файлы.
   
       
Authors 
~~~~~~~
Pavel Kurnosoff, 2:5030/736.25, pqr@yasp.com, icq 45906870 (up to 0.45pl3.1)
Lev Serebryakov, 2:5030/661.0, lev@serebryakov.spb.ru, icq 3670018

Download
~~~~~~~~
  http://lev.serebryakov.spb.ru/
  Fido: 2:5030/529 (alias QICO)
  Fido: 2:5030/661 (alias QICO)

$Id: README,v 1.4 2000/10/12 20:33:33 lev Exp $
